<div class="contact-page">
  <app-page-header 
    title="تواصل معنا" 
    [breadcrumbs]="breadcrumbs">
  </app-page-header>

  <div class="container-fluid py-5">
    <!-- Contact Form Section -->
    <div class="row mb-5">
      <div class="col-lg-8 mx-auto">
        <div class="card card-modern">
          <div class="section-header">
            <i class="pi pi-send me-2"></i>
            أرسل لنا رسالة
          </div>
          <div class="card-body p-4">
            <!-- Success Message -->
            <div class="alert alert-success d-flex align-items-center mb-4" 
                 *ngIf="showSuccessMessage && submissionResult?.success">
              <i class="pi pi-check-circle me-2"></i>
              {{ submissionResult?.message }}
            </div>

            <!-- Error Message -->
            <div class="alert alert-danger d-flex align-items-center mb-4" 
                 *ngIf="submissionResult && !submissionResult.success">
              <i class="pi pi-exclamation-triangle me-2"></i>
              {{ submissionResult.message }}
            </div>

            <form (ngSubmit)="onSubmit()" #contactFormRef="ngForm">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label fw-semibold">
                    <i class="pi pi-user me-1"></i>
                    الاسم الكامل *
                  </label>
                  <input 
                    type="text" 
                    class="form-control"
                    [class.is-invalid]="hasError('fullName')"
                    [(ngModel)]="contactForm.fullName"
                    name="fullName"
                    placeholder="أدخل اسمك الكامل"
                    required>
                  <div class="invalid-feedback" *ngIf="hasError('fullName')">
                    {{ getError('fullName') }}
                  </div>
                </div>
                
                <div class="col-md-6">
                  <label class="form-label fw-semibold">
                    <i class="pi pi-envelope me-1"></i>
                    البريد الإلكتروني *
                  </label>
                  <input 
                    type="email" 
                    class="form-control"
                    [class.is-invalid]="hasError('email')"
                    [(ngModel)]="contactForm.email"
                    name="email"
                    placeholder="أدخل عنوان بريدك الإلكتروني"
                    required>
                  <div class="invalid-feedback" *ngIf="hasError('email')">
                    {{ getError('email') }}
                  </div>
                </div>
                
                <div class="col-12">
                  <label class="form-label fw-semibold">
                    <i class="pi pi-tag me-1"></i>
                    الموضوع *
                  </label>
                  <input 
                    type="text" 
                    class="form-control"
                    [class.is-invalid]="hasError('subject')"
                    [(ngModel)]="contactForm.subject"
                    name="subject"
                    placeholder="أدخل موضوع الرسالة"
                    required>
                  <div class="invalid-feedback" *ngIf="hasError('subject')">
                    {{ getError('subject') }}
                  </div>
                </div>
                
                <div class="col-12">
                  <label class="form-label fw-semibold">
                    <i class="pi pi-comment me-1"></i>
                    الرسالة *
                  </label>
                  <textarea 
                    class="form-control"
                    [class.is-invalid]="hasError('message')"
                    [(ngModel)]="contactForm.message"
                    name="message"
                    rows="6"
                    placeholder="اكتب رسالتك هنا..."
                    required></textarea>
                  <div class="invalid-feedback" *ngIf="hasError('message')">
                    {{ getError('message') }}
                  </div>
                </div>
                
                <div class="col-12 text-center">
                  <button 
                    type="submit" 
                    class="btn btn-primary-custom"
                    [disabled]="isSubmitting">
                    <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2"></span>
                    <i *ngIf="!isSubmitting" class="pi pi-send me-2"></i>
                    {{ isSubmitting ? 'جاري الإرسال...' : 'إرسال الرسالة' }}
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Methods -->
    <div class="row mb-5">
      <div class="col-12">
        <h2 class="contact-methods-title text-center mb-4">تواصل معنا</h2>
        <div class="row">
          <div class="col-lg-3 col-md-6 mb-4" *ngFor="let method of contactMethods">
            <div class="contact-method-card text-center">
              <div class="method-icon mb-4" [style.background-color]="method.color">
                <i  [class]="method.icon"></i>
              </div>
              <h4 class="method-title">{{ method.title }}</h4>
              <p class="method-primary">{{ method.primary }}</p>
              <p class="method-secondary">{{ method.secondary }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Map and Campus Info -->
    <section class="contact-map-section py-5">
      <div class="container-fluid py-5">
        <div class="row mb-5">
          <!-- Interactive Map -->
          <div class="col-lg-8 mb-4">
            <p-card class="map-card">
              <ng-template pTemplate="header">
                <div class="map-header">
                  <h3 class="map-title">موقع الحرم الجامعي</h3>
                  <p class="map-subtitle">{{ campusInfo?.address }}</p>
                </div>
              </ng-template>

              <!-- Embedded Map -->
              <div class="map-container">
                <iframe
                  *ngIf="mapUrl"
                  [src]="mapUrl | safe: 'resourceUrl'"
                  width="100%"
                  height="450"
                  style="border:0;"
                  allowfullscreen=""
                  loading="lazy"
                  referrerpolicy="no-referrer-when-downgrade">
                </iframe>
              </div>

              <ng-template pTemplate="footer">
                <div class="map-actions">
                  <p-button
                    label="فتح في خرائط جوجل"
                    icon="pi pi-external-link"
                    class="me-2 mb-2 p-4"
                    (click)="openGoogleMaps()">
                  </p-button>
                  <p-button
                    label="الحصول على الاتجاهات"
                    icon="pi pi-compass"
                    severity="secondary"
                    [outlined]="true"
                    class="mb-2 p-4"
                    (click)="getDirections()">
                  </p-button>
                </div>
              </ng-template>
            </p-card>
          </div>

          <!-- Campus Information -->
          <div class="col-lg-4 mb-4">
            <p-card class="campus-info-card">
              <ng-template pTemplate="header">
                <div class="campus-info-header">
                  <h3 class="campus-info-title">معلومات الحرم الجامعي</h3>
                </div>
              </ng-template>

              <div class="campus-details">
                <div class="campus-detail">
                  <i class="pi pi-building"></i>
                  <div class="detail-content">
                    <h5>{{ campusInfo?.name }}</h5>
                    <p>{{ campusInfo?.address }}</p>
                  </div>
                </div>
                <div class="campus-detail">
                  <i class="pi pi-phone"></i>
                  <div class="detail-content">
                    <h5>الهاتف</h5>
                    <p>{{ campusInfo?.phone }}</p>
                  </div>
                </div>
                <div class="campus-detail">
                  <i class="pi pi-envelope"></i>
                  <div class="detail-content">
                    <h5>البريد الإلكتروني</h5>
                    <p>{{ campusInfo?.email }}</p>
                  </div>
                </div>
              </div>

              <div class="campus-features">
                <h5 class="features-title">مميزات الحرم الجامعي</h5>
                <div class="feature-item" *ngFor="let feature of campusFeatures">
                  <div class="feature-icon">
                    <i [class]="feature.icon"></i>
                  </div>
                  <div class="feature-content">
                    <h6 class="feature-title">{{ feature.title }}</h6>
                    <p class="feature-description">{{ feature.description }}</p>
                  </div>
                </div>
              </div>
            </p-card>
          </div>
        </div>
      </div>
    </section>
  </div>
  <app-footer></app-footer>
</div>